geom_point()
ggplot(df_sum["South_Korea"]) +
geom_point()
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
df_sum$Date
df_sum[c("Date","South_Korea")]
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point()
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=1)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=2)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=0)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=1)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=4)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=3)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=4)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=4)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=5)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=6)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=17)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=18)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=19)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=120)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=20)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=21)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=29)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=9)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=7)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=7)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=6)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=17)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=16)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=15)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=14)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=13)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=12)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point(shape=1)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point()
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point() +
theme_classic() #+
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point() +
theme(legend.title=element_text(size=10,face="bold"),plot.title=element_text(size=15, hjust=0.5, face="bold", vjust=2))
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none)+
theme(legend.title=element_text(size=10,face="bold"),plot.title=element_text(size=15, hjust=0.5, face="bold", vjust=2))
library(scales)
# Plotting of South Korea
#before_NWR =
ggplot(df_sum[c("Date","South_Korea")],
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
theme(legend.title=element_text(size=10,face="bold"),plot.title=element_text(size=15, hjust=0.5, face="bold", vjust=2))
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
df_sum$Date
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
df_sum$Date
#### set_date : setting study period ####
set_date <- function(x=0){
max_date <- as.integer(as.Date(Sys.Date(),formate="%Y/%m/%d")-
as.Date("2019-12-31",formate="%Y/%m/%d"))
return(max_date)
}
set_date("2020/08/31")
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
df_sum$Date
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
#### set_date : setting study period ####
set_date <- function(x=0){
if(x==0){
max_date <- as.integer(as.Date(Sys.Date(),formate="%Y/%m/%d")-
as.Date("2019-12-31",formate="%Y/%m/%d"))
}else{
max_date <- as.integer(as.Date(x,formate="%Y/%m/%d")-
as.Date("2019-12-31",formate="%Y/%m/%d"))
}
return(max_date)
}
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
as.integer(as.Date(df_sum$Date,formate="%Y/%m/%d")-
as.Date("2019-12-31",formate="%Y/%m/%d"))
#### set_date : setting study period ####
set_date <- function(x="2019-12-31"){
max_date <- as.integer(as.Date(x,formate="%Y/%m/%d")-
as.Date("2019-12-31",formate="%Y/%m/%d"))
return(max_date)
}
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date(df_sum$Date)
# df_result = read.csv("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(날짜 수정)/result/segmentation_result.csv")
set_date()
# Plotting of South Korea
#before_NWR =
ggplot(df_sum %>% mutate(Date = set_date(Date)),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
theme(legend.title=element_text(size=10,face="bold"),plot.title=element_text(size=15, hjust=0.5, face="bold", vjust=2))
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases" )
# Plotting of South Korea
#before_NWR =
ggplot(df_sum %>% mutate(Date = set_date(Date)),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
theme(legend.title=element_text(size=10,face="bold"),plot.title=element_text(size=15, hjust=0.5, face="bold", vjust=2))+
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases" )
# Plotting of South Korea
#before_NWR =
ggplot(df_sum %>% mutate(Date = set_date(Date)),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases" )
ggsave(Before_NWR, filename = "Before_NWR.jpeg", path = paste0("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/plot/etc"), dpi = 600, width = 8, height = 6)
# Plotting of South Korea
Before_NWR = ggplot(df_sum %>% mutate(Date = set_date(Date)),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases" )
ggsave(Before_NWR, filename = "Before_NWR.jpeg", path = paste0("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/plot/etc"), dpi = 600, width = 8, height = 6)
ggplot(df_result %>% mutate(Date = set_date(Date)),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases" )
df_result
ksmooth(set_date(df_sum$Date),df_sum$South_Korea,kernel="normal",bandwidth = 14)$y
ggplot(df_sum %>% mutate(Date = set_date(Date),
South_Korea = ksmooth(set_date(df_sum$Date),df_sum$South_Korea,kernel="normal",bandwidth = 14)$y),
aes(x=Date,y=South_Korea)) +
geom_point()
ggplot(df_sum %>% mutate(Date = set_date(Date), South_Korea = ksmooth(set_date(df_sum$Date),df_sum$South_Korea,kernel="normal",bandwidth = 14)$y),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases" )
After_NWR = ggplot(df_sum %>% mutate(Date = set_date(Date), South_Korea = ksmooth(set_date(df_sum$Date),df_sum$South_Korea,kernel="normal",bandwidth = 14)$y),
aes(x=Date,y=South_Korea)) +
geom_point() +
scale_y_continuous(limits=c(0,1000),oob = rescale_none) +
labs(title="South_Korea",subtitle = "Since 2020-01-01", y="Daily new confirmed cases")
ggsave(After_NWR, filename = "After_NWR", path = paste0("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/plot/etc"), dpi = 600, width = 8, height = 6)
ggsave(After_NWR, filename = "After_NWR.jpeg", path = paste0("C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/plot/etc"), dpi = 600, width = 8, height = 6)
#rm(list=ls())
library(dplyr)
library(PerformanceAnalytics)
#### Importing Data ####
# Importing daily confirmed cases data
# Path
path <- "C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/"
data_path <- paste0(path, "data/")
result_path <- paste0(path, "result/")
plot_path <- paste0(path, "plot/SLR/")
coef_Logi <- read.csv("result/segmented_Logistic_result.csv")[1:7]
colnames(coef_Logi) <- c("Country",
"α1(Logistic)", "β1(Logistic)", "γ1(Logistic)",
"α2(Logistic)", "β2(Logistic)", "γ2(Logistic)")
coef_Gomp <- read.csv("result/segmented_Gompertz_result.csv")[1:7]
colnames(coef_Gomp) <- c("Country",
"α1(Gompertz)", "β1(Gompertz)", "γ1(Gompertz)",
"α2(Gompertz)", "β2(Gompertz)", "γ2(Gompertz)")
coef_total <- cbind(coef_Logi, coef_Gomp)[,-8]
#### Correlation Analysis ####
# correlation coefficients of Logistic Models
chart.Correlation(log(coef_Logi[, c(2:7)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Logi[, c(2:4)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Logi[, c(5:7)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Logi[, c(2,5)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Logi[, c(3,6)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Logi[, c(4,7)]), histogram = TRUE, pch=19)
# correlation coefficients of Gompertz Models
chart.Correlation(log(coef_Gomp[, c(2:7)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Gomp[, c(2:4)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Gomp[, c(5:7)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_Gomp[, c(2,5)]), histogram = TRUE, pch=19,main="dfd")
chart.Correlation(log(coef_Gomp[, c(2,5)]), histogram = TRUE, pch=19,time="dfd")
chart.Correlation(log(coef_Gomp[, c(2,5)]), histogram = TRUE, pch=19,tile="dfd")
chart.Correlation(log(coef_Gomp[, c(2,5)]), histogram = TRUE, pch=19,title="dfd")
chart.Correlation(log(coef_Gomp[, c(4,7)]), histogram = TRUE, pch=19)
# correlation coefficients of both models in the same segment.
chart.Correlation(log(coef_total[,c(2:4, 8:10)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_total[,c(5:7, 11:13)]), histogram = TRUE, pch=19)
# correlation coefficients of both models in the same segment.
chart.Correlation(log(coef_total[,c(2:4, 8:10)]), histogram = TRUE, pch=19)
#### Correlation Analysis ####
# correlation coefficients of Logistic Models
chart.Correlation(log(coef_Logi[, c(2:7)]), histogram = TRUE, pch=19)
# correlation coefficients of Gompertz Models
chart.Correlation(log(coef_Gomp[, c(2:7)]), histogram = TRUE, pch=19)
#### Correlation Analysis ####
# correlation coefficients of Logistic Models
Correlation_Logistic = chart.Correlation(log(coef_Logi[, c(2:7)]), histogram = TRUE, pch=19)
#### Correlation Analysis ####
# correlation coefficients of Logistic Models
jpeg(filename=paste0("plot/etc/Correlation_Logistic.jpeg"), width = 8, height = 8, units = 'in',res=600)
chart.Correlation(log(coef_Logi[, c(2:7)]), histogram = TRUE, pch=19)
dev.off()
# correlation coefficients of Gompertz Models
jpeg(filename=paste0("plot/etc/Correlation_Gompertz.jpeg"), width = 8, height = 8, units = 'in',res=600)
chart.Correlation(log(coef_Gomp[, c(2:7)]), histogram = TRUE, pch=19)
dev.off()
# correlation coefficients of both models in the same segment.
jpeg(filename=paste0("plot/etc/Correlation_Logistic vs Gompertz(segment1).jpeg"), width = 8, height = 8, units = 'in',res=600)
chart.Correlation(log(coef_total[,c(2:4, 8:10)]), histogram = TRUE, pch=19)
dev.off()
jpeg(filename=paste0("plot/etc/Correlation_Logistic vs Gompertz(segment2).jpeg"), width = 8, height = 8, units = 'in',res=600)
chart.Correlation(log(coef_total[,c(5:7, 11:13)]), histogram = TRUE, pch=19)
dev.off()
rm(list=ls())
#rm(list=ls())
library(dplyr)
library(PerformanceAnalytics)
#### Importing Data ####
# Importing daily confirmed cases data
# Path
path <- "C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/"
data_path <- paste0(path, "data/")
result_path <- paste0(path, "result/")
plot_path <- paste0(path, "plot/SLR/")
coef_Logi <- read.csv("result/segmented_Logistic_result.csv")[1:7]
colnames(coef_Logi) <- c("Country",
"α1(Logistic)", "β1(Logistic)", "γ1(Logistic)",
"α2(Logistic)", "β2(Logistic)", "γ2(Logistic)")
coef_Gomp <- read.csv("result/segmented_Gompertz_result.csv")[1:7]
colnames(coef_Gomp) <- c("Country",
"α1(Gompertz)", "β1(Gompertz)", "γ1(Gompertz)",
"α2(Gompertz)", "β2(Gompertz)", "γ2(Gompertz)")
coef_total <- cbind(coef_Logi, coef_Gomp)[,-8]
chart.Correlation(log(coef_Logi[, c(2:7)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_total[,c(2:4, 8:10)]), histogram = TRUE, pch=19)
chart.Correlation(log(coef_total[,c(5:7, 11:13)]), histogram = TRUE, pch=19)
set_date("2020/08/31")
View(set_date)
View(set_date)
View(set_date)
set_date("2020/01/01")
#### tscount model ####
# peaks
plot(data_df$DailyConfirmed,xlim=c(0,450),xlab="time",ylab="Daily Confirmed Cases", main="Daily confirmed cases")
library(ggplot2)
library(tscount)
library(dplyr)
#### data preprocessing ####
today <- Sys.Date()
today <- format(today, format="%y%m%d")
data_date <- "20210204"
save_path <- paste0(getwd(), "/", today)
if (!dir.exists(save_path)) {
dir.create(save_path)
}
y_variables <- c("DailyConfirmed", "DailyDeath")
original_data = as.data.frame(read.csv(paste0("COVID_19_Cases_Korea_Merged_Fin_", data_date, ".csv"), stringsAsFactors = F))
#rm(list=ls())
library(dplyr)
library(ggplot2)
library(forcats)
library(scales)
library(ggrepel)
# Path
path <- "C:/Users/김학용/Desktop/코로나 연구 인턴/주차별 작업사항/최종 정리(8.31)/"
data_path <- paste0(path, "data/")
result_path <- paste0(path, "result/")
plot_path <- paste0(path, "plot/SLR/")
getwd()
#### Bar Plot pf p_value ####
param_name = c("a", "b", "c")
model_name = c("Logistic", "Gompertz")
title_box = c(
expression("P-Value of "~theta[1]~" of"~bold(alpha) ~"~ National Factors(Logistic) "),
expression("P-Value of "~theta[1]~" of"~bold(beta) ~"~ National Factors(Logistic) "),
expression("P-Value of "~theta[1]~" of"~bold(gamma) ~"~ National Factors(Logistic) "),
expression("P-Value of "~theta[1]~" of"~bold(alpha) ~"~ National Factors(Gompertz) "),
expression("P-Value of "~theta[1]~" of"~bold(beta) ~"~ National Factors(Gompertz) "),
expression("P-Value of "~theta[1]~" of"~bold(gamma) ~"~ National Factors(Gompertz) ")
)
for (i in 1:3){
for(j in 1:2){
ii = i+3 + ifelse(j==2,3,0)
jj = j
if(j==1){
df_model <- data.frame(
National_Factors = factor(unique(df_sum1$Explanatory)),
coefficient = c(df_sum1[,ii][which((1:nrow(df_sum1))%%3==1)], df_sum2[,ii][which((1:nrow(df_sum2))%%3==1)]),
p.value_scaled = -log(c(df_sum1[,ii][which((1:nrow(df_sum1))%%3==0)], df_sum2[,ii][which((1:nrow(df_sum2))%%3==0)])),
segment = factor(rep(1:2, each=length(unique(df_sum1$Explanatory))))
# category = factor(c(7,7,1,1,7,5,4,4,7,3,3,6,5,5,2,1,1,1,2,2,2,6,7,7,7,7,7,7,7,2,5))
# Territory&population : 1 / Age : 2 / Trade : 3 / Environment : 4 /
# Education&Culture&Science : 5 / National Accounts : 6 /
# Health&Sociecy&Welfare : 7
) %>% arrange(National_Factors)
}else{
df_model <- data.frame(
National_Factors = factor(unique(df_sum1$Explanatory)),
coefficient = c(df_sum1[,ii][which((1:nrow(df_sum1))%%3==1)], df_sum2[,ii][which((1:nrow(df_sum2))%%3==1)]),
p.value_scaled = -log(c(df_sum1[,ii][which((1:nrow(df_sum1))%%3==0)], df_sum2[,ii][which((1:nrow(df_sum2))%%3==0)])),
segment = factor(rep(1:2, each=length(unique(df_sum1$Explanatory))))
# category = factor(c(7,7,1,1,7,5,4,4,7,3,3,6,5,5,2,1,1,1,2,2,2,1,7,7,7,7,7,7,7,2,5))
) %>% arrange(National_Factors,segment)
}
#bar plot
bar_plot = ggplot(df_model %>%
mutate(National_Factors = fct_reorder(National_Factors,desc(National_Factors))),
aes(x=National_Factors, y=p.value_scaled, fill=fct_rev(segment))) +
geom_bar(stat="identity", position="dodge") +
labs(fill="Segment") +
guides(fill = guide_legend(reverse=TRUE))+
geom_hline(yintercept=-log(0.05), color = 2, size=0.5, linetype=8) +
labs(title=title_box[ii-3],subtitle = "", y="-log(p.value)" ) +
coord_flip() +
scale_fill_manual(values=c("#56B4E9","#E69F00")) +
theme_classic() +
theme(plot.title=element_text(size=15, hjust=0.5, face='bold.italic',vjust=2),
legend.title = element_text(face = "bold.italic"),
legend.text = element_text(face = "italic"))
ggsave(bar_plot, filename = paste0(model_name[jj],"_",param_name[i], ".jpeg"), path = paste0(plot_path,"barplot_p.value/"), dpi = 600, width = 8, height = 8.5)
}
}
#### Bar Plot pf coefficient ####
param_name = c("a","b","c")
model_name = c("Logistic", "Gompertz")
seg_name =  c("Segment 1", "Segment 2")
title_box = c(
expression(theta[1]~" of"~bold(alpha) ~"~ National Factors(Segment1, Logistic) "),
expression(theta[1]~" of"~bold(alpha) ~"~ National Factors(Segment1, Gompertz) "),
expression(theta[1]~" of"~bold(alpha) ~"~ National Factors(Segment2, Logistic) "),
expression(theta[1]~" of"~bold(alpha) ~"~ National Factors(Segment2, Gompertz) "),
expression(theta[1]~" of"~bold(beta) ~"~ National Factors(Segment1, Logistic) "),
expression(theta[1]~" of"~bold(beta) ~"~ National Factors(Segment1, Gompertz) "),
expression(theta[1]~" of"~bold(beta) ~"~ National Factors(Segment2, Logistic) "),
expression(theta[1]~" of"~bold(beta) ~"~ National Factors(Segment2, Gompertz) "),
expression(theta[1]~" of"~bold(gamma) ~"~ National Factors(Segment1, Logistic) "),
expression(theta[1]~" of"~bold(gamma) ~"~ National Factors(Segment1, Gompertz) "),
expression(theta[1]~" of"~bold(gamma) ~"~ National Factors(Segment2, Logistic) "),
expression(theta[1]~" of"~bold(gamma) ~"~ National Factors(Segment2, Gompertz) ")
)
loop_count = 0
for (i in 1:3){ # parameter
for(j in 1:2){ # segment
for(k in 1:2){ # model
ii = i+3+ifelse(k==2,3,0)
if(j==1){
df_model <- data.frame(
National_Factors = factor(unique(df_sum1$Explanatory)),
coefficient = c(df_sum1[,ii][which((1:nrow(df_sum1))%%3==1)]),
category = factor(c(7,7,1,1,7,5,4,4,7,3,3,6,5,5,2,1,1,1,2,2,2,1,7,7,7,7,7,7,7,2,5)),
significant_var = factor( ifelse(as.numeric(df_sum1[,ii][which((1:nrow(df_sum1))%%3==0)]<0.05)+rep(0,31)==1,
"significant","non-significant"))
) %>% arrange(National_Factors)
}else{
df_model <- data.frame(
National_Factors = factor(unique(df_sum1$Explanatory)),
coefficient = c(df_sum2[,ii][which((1:nrow(df_sum2))%%3==1)]),
category = factor(c(7,7,1,1,7,5,4,4,7,3,3,6,5,5,2,1,1,1,2,2,2,1,7,7,7,7,7,7,7,2,5)),
significant_var = factor( ifelse(as.numeric(df_sum2[,ii][which((1:nrow(df_sum2))%%3==0)]<0.05)+rep(0,31)==1,
"significant","non-significant"))
) %>% arrange(National_Factors)
}
x_max = max(abs(df_model$coefficient))
loop_count = loop_count + 1
# beta1 of c ~ Time-Independent-Variable
#bar plot
bar_plot = ggplot(df_model %>%
mutate(National_Factors = fct_reorder(National_Factors, desc(National_Factors))),
aes(x=National_Factors, y=coefficient, fill=significant_var)) +
geom_bar(stat="identity", position="dodge") +
labs(fill="Significance",face="bold") +
guides(fill = guide_legend(reverse=TRUE))+
scale_y_continuous(limits=c(-x_max,x_max),oob = rescale_none)+
labs(title = title_box[loop_count],subtitle = "") +
coord_flip() +
scale_fill_manual(values=c("#56B4E9", "#E69F00")) +
theme_classic() +
theme(legend.title=element_text(size=10,face="bold"),plot.title=element_text(size=15, hjust=0.5, face="bold", vjust=2))
ggsave(bar_plot, filename = paste0(model_name[k],"_",param_name[i],"_",seg_name[j], ".jpeg"), path = paste0(plot_path,"barplot_coefficient/"), dpi = 600, width = 8, height = 8.5)
}
}
}
